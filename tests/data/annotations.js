/**
  Juju Annotations version 2.
  This API facade is available on model connections.

  NOTE: this file has been generated by the generate command in js-libjuju
  on Wed 2042/01/01 16:42:47 UTC. Do not manually edit this file.
*/

'use strict';


/**
  Annotations!
*/
class AnnotationsV2 {

  constructor(transport, info) {
    this._transport = transport;
    this._info = info;
    this.version = 2;
  }

  /**
    Get returns annotations for given entities. If annotations cannot be
    retrieved for a given entity, an error is returned. Each entity is
    treated independently and, hence, will fail or succeed independently.

    @param {Object} args Arguments to be provided to Juju, as an object like
      the following:
        {
          entities: []{
            tag: string
          }
        }
    @param {Function} callback Called when the response from Juju is available,
      the callback receives an error and the result. If there are no errors,
      the result is provided as an object like the following:
        {
          results: []{
            entity: string,
            annotations: map[string]string,
            error: {
              error: {
                message: string,
                code: string
              }
            }
          }
        }
  */
  get(args, callback) {
    // Prepare request parameters.
    let params;
    // github.com/juju/juju/apiserver/params#Entities
    params = {};
    args = args || {};
    params['entities'] = [];
    args.entities = args.entities || [];
    for (let _s6 = 0; _s6 < args.entities.length; _s6++) {
      // github.com/juju/juju/apiserver/params#Entity
      params['entities'][_s6] = {};
      args.entities[_s6] = args.entities[_s6] || {};
      params['entities'][_s6]['tag'] = args.entities[_s6].tag;
    }
    // Prepare the request to the Juju API.
    const req = {
      type: 'Annotations',
      request: 'Get',
      version: 2,
      params: params
    };
    // Send the request to the server.
    this._transport.write(req, (err, resp) => {
      if (!callback) {
        return;
      }
      if (err) {
        callback(err, {});
        return;
      }
      // Handle the response.
      let result;
      // github.com/juju/juju/apiserver/params#AnnotationsGetResults
      result = {};
      resp = resp || {};
      result.results = [];
      resp['results'] = resp['results'] || [];
      for (let _s7 = 0; _s7 < resp['results'].length; _s7++) {
        // github.com/juju/juju/apiserver/params#AnnotationsGetResult
        result.results[_s7] = {};
        resp['results'][_s7] = resp['results'][_s7] || {};
        result.results[_s7].entity = resp['results'][_s7]['entity'];
        resp['results'][_s7]['annotations'] = resp['results'][_s7]['annotations'] || {};
        for (let _m1 in resp['results'][_s7]['annotations']) {
          result.results[_s7].annotations[_m1] = resp['results'][_s7]['annotations'][_m1];
        }
        // github.com/juju/juju/apiserver/params#ErrorResult
        result.results[_s7].error = {};
        resp['results'][_s7]['error'] = resp['results'][_s7]['error'] || {};
        // github.com/juju/juju/apiserver/params#Error
        result.results[_s7].error.error = {};
        resp['results'][_s7]['error']['error'] = resp['results'][_s7]['error']['error'] || {};
        result.results[_s7].error.error.message = resp['results'][_s7]['error']['error']['message'];
        result.results[_s7].error.error.code = resp['results'][_s7]['error']['error']['code'];
      }
      callback(null, result);
    });
  }

  /**
    Set stores annotations for given entities

    @param {Object} args Arguments to be provided to Juju, as an object like
      the following:
        {
          annotations: []{
            entity: string,
            annotations: map[string]string
          }
        }
    @param {Function} callback Called when the response from Juju is available,
      the callback receives an error and the result. If there are no errors,
      the result is provided as an object like the following:
        {
          results: []{
            error: {
              message: string,
              code: string
            }
          }
        }
  */
  set(args, callback) {
    // Prepare request parameters.
    let params;
    // github.com/juju/juju/apiserver/params#AnnotationsSet
    params = {};
    args = args || {};
    params['annotations'] = [];
    args.annotations = args.annotations || [];
    for (let _s8 = 0; _s8 < args.annotations.length; _s8++) {
      // github.com/juju/juju/apiserver/params#EntityAnnotations
      params['annotations'][_s8] = {};
      args.annotations[_s8] = args.annotations[_s8] || {};
      params['annotations'][_s8]['entity'] = args.annotations[_s8].entity;
      args.annotations[_s8].annotations = args.annotations[_s8].annotations || {};
      for (let _m2 in args.annotations[_s8].annotations) {
        params['annotations'][_s8]['annotations'][_m2] = args.annotations[_s8].annotations[_m2];
      }
    }
    // Prepare the request to the Juju API.
    const req = {
      type: 'Annotations',
      request: 'Set',
      version: 2,
      params: params
    };
    // Send the request to the server.
    this._transport.write(req, (err, resp) => {
      if (!callback) {
        return;
      }
      if (err) {
        callback(err, {});
        return;
      }
      // Handle the response.
      let result;
      // github.com/juju/juju/apiserver/params#ErrorResults
      result = {};
      resp = resp || {};
      result.results = [];
      resp['results'] = resp['results'] || [];
      for (let _s9 = 0; _s9 < resp['results'].length; _s9++) {
        // github.com/juju/juju/apiserver/params#ErrorResult
        result.results[_s9] = {};
        resp['results'][_s9] = resp['results'][_s9] || {};
        // github.com/juju/juju/apiserver/params#Error
        result.results[_s9].error = {};
        resp['results'][_s9]['error'] = resp['results'][_s9]['error'] || {};
        result.results[_s9].error.message = resp['results'][_s9]['error']['message'];
        result.results[_s9].error.code = resp['results'][_s9]['error']['code'];
      }
      callback(null, result);
    });
  }
}


const wrappers = require('../wrappers.js');
if (wrappers.wrapAnnotations) {
  // Decorate the facade class in order to improve user experience.
  AnnotationsV2 = wrappers.wrapAnnotations(AnnotationsV2);
}

module.exports = AnnotationsV2;
